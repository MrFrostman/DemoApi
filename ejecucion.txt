Cadena de conexion a la database

"AppDb": "Server=localhost;port=5432;user id=postgres;password=carp3di3m;database=auth;pooling=true"

Esta en Product.Api/appsettings.json linea 10

Instalacion de DOTNET en UBUNTU

https://docs.microsoft.com/en-us/dotnet/core/install/linux-ubuntu#2004-

Con el SDK Basta

Version usada la 6 es la actual.

Instalar EntityFramework manejador de base de datos

dotnet tool install --global dotnet-ef


# Con este comando migras toda la DB a Postgresql 14.
dotnet ef database update --project Product.Infrastructure --startup-project Product.Api


dotnet publish --configuration Release
Con este comando se genera DLL el que importa es el de Product.Api ese se coloca en el archivo service




/etc/systemd/system/miapp.service

[Unit]
Description=Backend

[Service]
WorkingDirectory=/ruta_del_proyecto/Product.Api
ExecStart=/usr/bin/dotnet /ruta_del_proyecto/Product.Api/bin/Release/net6.0/Product.Api.dll
Restart=always
RestartSec=10
SyslogIdentifier=api
User=www-data
Environment=ASPNETCORE_ENVIRONMENT=Production
Environment=DOTNET_PRINT_TELEMETRY_MESSAGE=false

[Install]


 systemctl start api


 En el NGINX apuntas al puerto 5000


VirtualHost de Nginx

 server {
        listen 80;
        root /ruta_del_proyecto;

        server_name midominio.com;
        access_log /home/access.log;
        server_tokens off;
        location /
        {
                proxy_pass         http://127.0.0.1:5000;
                proxy_http_version 1.1;
                proxy_set_header   Upgrade $http_upgrade;
                proxy_set_header   Connection keep-alive;
                proxy_set_header   Host $host;
                proxy_cache_bypass $http_upgrade;
                proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header   X-Forwarded-Proto $scheme;
        }

}

